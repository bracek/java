<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:p="http://primefaces.org/ui">
<h:head>
    <title>Credit's cards</title>
</h:head>
<h:body>
    <p:messages></p:messages>

    <h:form id="form">
        <p:growl id="msgs" showDetail="true"/>

        <table>
            <tr>
                <td>
                    <h:outputLabel for="id" value="Id : "/>
                </td>
                <td>
                    <p:inputText id="id" value="#{cardsBean.id}"
                                 disabled="true">
                        <f:converter converterId="javax.faces.Integer"/>
                        <p:ajax event="blur" update="idMsg"/>
                    </p:inputText>
                    <p:message id="idMsg" for="id" display="icon"/>
                </td>
            </tr>
            <tr>
                <td>
                    <h:outputLabel for="slsp" value="Slsp: "/>
                </td>
                <td>
                    <p:inputText id="slsp"
                                 value="#{cardsBean.slsp}">
                        <f:validateLength minimum="1"/>
                        <p:ajax event="blur" update="slspMsg"/>
                    </p:inputText>
                    <p:message id="slspMsg" for="slsp" display="icon"/>
                </td>
            </tr>
            <tr>
                <td>
                    <h:outputLabel for="autokarta" value="Autokarta: "/>
                </td>
                <td>
                    <p:inputText id="autokarta"
                                 value="#{cardsBean.autokarta}">
                        <f:validateLength minimum="1"/>
                        <p:ajax event="blur" update="autokartaSlsp"/>
                    </p:inputText>
                    <p:message id="autokartaSlsp" for="autokarta" display="icon"/>
                </td>
            </tr>
            <tr>
                <td colspan="2">
                    <p:calendar id="inline" value="#{cardsBean.date}" mode="inline"/>
                </td>
            </tr>


            <tr>
                <td>
                    <p:commandButton id="addUser" value="Add"
                                     actionListener="#{cardsBean.addEntity}" ajax="false"/>
                </td>
                <td>
                    <p:commandButton id="reset" value="Reset"
                                     actionListener="#{cardsBean.reset}" ajax="false"/>
                </td>
            </tr>
        </table>

        Elements:
        <p:dataTable id="entities" var="entity" value="#{cardsBean.entityList}" editable="true" editMode="cell"
                     widgetVar="cellCars"
                     paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {Exporters}"
                     paginator="true" rows="10" style="margin-bottom:20px">

            <p:growl id="cardMsgs" showDetail="true"/>

            <!--<p:ajax event="cellEdit" listener="#{cardsBean.onCellEdit}" update=":entities:cardMsgs"/>-->
            <p:ajax event="cellEdit" listener="#{cardsBean.onCellEdit}" update="entities"/>

            <p:column>
                <f:facet name="header">
                    <h:outputText value="ID"/>
                </f:facet>
                <h:outputText value="#{entity.id}"/>
            </p:column>

            <p:column headerText="Slsp">
                <p:cellEditor>
                    <f:facet name="output"><h:outputText value="#{entity.slsp}"/></f:facet>
                    <f:facet name="input"><p:inputText value="#{entity.slsp}" style="width:96%"
                                                       label="Slsp"/></f:facet>
                </p:cellEditor>
            </p:column>

            <p:column headerText="Autokarta">
                <p:cellEditor>
                    <f:facet name="output"><h:outputText value="#{entity.autokarta}"/></f:facet>
                    <f:facet name="input"><p:inputText value="#{entity.autokarta}" style="width:96%"
                                                       label="Autokarta"/></f:facet>
                </p:cellEditor>
            </p:column>

            <p:column>
                <f:facet name="header">
                    <h:outputText value=""/>
                </f:facet>
                <p:commandButton icon="ui-icon-close" title="remove from card"
                                 actionListener="#{cardsBean.removeItem(entity)}" update="entities"/>
            </p:column>
        </p:dataTable>

        <p:chart type="line" model="#{cardsBean.chartModel}" style="height:300px"/>
    </h:form>
</h:body>
</html>
